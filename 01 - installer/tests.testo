
include "os_installation.testo"

flash my_super_flash {
	fs: "ntfs"
	size: 16Mb
	folder: "./dist"
}

test install_my_super_app: win10_prepare {
	win10 {
		plug flash my_super_flash
		mouse click "USB Drive (E:)"
		sleep 5s
		mouse click "Open folder to view files"
		mouse dclick "MySuperApp"
		wait "The installer will guide you through the steps"
		mouse click "Next".from_bottom(0)
		wait "Select Installation Folder"
		mouse click "Everyone"
		mouse click "Next".from_bottom(0)
		wait "Confirm Installation"
		mouse click "Next".from_bottom(0)
		wait "Do you want to allow this app"
		mouse click "Yes".from_bottom(0)
		wait "Installation complete"
		mouse click "Close".from_bottom(0)
		wait !"Installation complete"
		press LeftAlt + F4
		wait !"USB Drive (E:)"
		unplug flash my_super_flash
	}
}

[no_snapshots: true]
test test_desktop_icon: install_my_super_app {
	win10 {
		mouse dclick "MySuperApp"
		wait "MySuperApp is working!"
	}
}

[no_snapshots: true]
test test_context_menu: install_my_super_app {
	win10 {
		mouse move 300 200
		mouse rclick
		mouse move "New"
		mouse click "Text Document".from_bottom(0)
		wait "New Text"
		press Enter
		mouse rclick "New Text"
		mouse click "Open with My Super App"
		wait "Opened New Text Document.txt"
	}
}

[no_snapshots: true]
test uninstall_my_super_app: install_my_super_app {
	win10 {
		mouse click "Type here to search"
		wait "Top apps"
		type "Apps & Features"
		wait "System settings"
		press Enter
		mouse click "Search this list"
		sleep 5s
		type "My Super App"
		wait "1 app found"
		press Down
		sleep 5s
		mouse click "My Super App".from_bottom(0)
		mouse click "Uninstall"
		wait "This app and its related"
		mouse click "Uninstall".from_bottom(1)
		sleep 5s
		press LeftAlt+Tab
		wait "Do you want to allow"
		mouse click "Yes"
		wait "We couldn't find"
		press LeftAlt+F4
		wait !"My Super App"
	}
}